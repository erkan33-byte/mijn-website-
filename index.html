<!DOCTYPE html>
<html>
<head>
  <title>BTC Key Generator + Balance Check</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bitcoinjs-lib/3.3.2/bitcoinjs.min.js"></script>
</head>
<body>
  <h2>BTC Key Generator + Balance Check</h2>
  <pre id="output"></pre>
  <button id="startBtn">Start zoeken</button>
  <button id="stopBtn">Stoppen</button>

  <script>
    const output = document.getElementById("output");
    const startBtn = document.getElementById("startBtn");
    const stopBtn = document.getElementById("stopBtn");
    let searching = false;

    async function checkBalance(address) {
      const url = `https://api.blockcypher.com/v1/btc/main/addrs/${address}/balance`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        return data.final_balance || 0;
      } catch {
        return 0;
      }
    }

    async function generateAndCheck() {
      const keyPair = bitcoin.ECPair.makeRandom();
      const { address } = bitcoin.payments.p2pkh({ pubkey: keyPair.publicKey });
      const wif = keyPair.toWIF();

      output.textContent += `Address: ${address}\n`;

      const balance = await checkBalance(address);
      output.textContent += `Balance: ${balance} satoshi\n\n`;

      if (balance > 0) {
        output.textContent += `ðŸŽ‰ FOUND! Address: ${address}\nPrivate Key (WIF): ${wif}\n`;
        searching = false;
        return true;
      }
      return false;
    }

    async function searchLoop() {
      if (!searching) return;
      const found = await generateAndCheck();
      if (!found && searching) {
        setTimeout(searchLoop, 500);
      }
    }

    startBtn.addEventListener("click", () => {
      if (!searching) {
        searching = true;
        output.textContent += "ðŸš€ Start zoeken...\n";
        searchLoop();
      }
    });

    stopBtn.addEventListener("click", () => {
      searching = false;
      output.textContent += "â›” Gestopt door gebruiker.\n";
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>BTC Key Generator (Random + Incremental + Hybrid)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/elliptic/6.5.4/elliptic.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
table { border-collapse: collapse; width: 100%; margin-top: 15px; }
th, td { border: 1px solid #ccc; padding: 8px; font-size: 14px; word-break: break-all; }
th { background: #f2f2f2; }
button, input, select { margin-bottom: 10px; padding: 8px 12px; }
#totaal, #errors, #progressAbs, #progressRel { margin-bottom: 10px; font-weight: bold; }
#foundMsg, #retryMsg, #currentApi { margin-top: 15px; font-weight: bold; font-size: 16px; }
#foundMsg { color: green; }
#retryMsg { color: orange; animation: blink 1s infinite; }
@keyframes blink { 0%,50%,100% {opacity:1;} 25%,75% {opacity:0;} }
label { display:inline-block; min-width:200px; }
</style>
</head>
<body>
<h2>BTC Key Generator (Random + Incremental + Hybrid - Alleen Uncompressed)</h2>

<label for="mode">Modus:</label>
<select id="mode">
  <option value="random" selected>Random</option>
  <option value="incremental">Incremental</option>
  <option value="hybrid">Hybrid</option>
</select><br>

<label for="startPercent">Start (%) :</label>
<input type="number" id="startPercent" value="10" min="0" max="100" step="0.0001"><br>
<label for="endPercent">Eind (%) :</label>
<input type="number" id="endPercent" value="20" min="0" max="100" step="0.0001"><br>
<label for="numSteps">Aantal stappen (alleen gebruikt voor berekening):</label>
<input type="number" id="numSteps" value="1000000" min="1"><br>

<div id="hybridSettings" style="display:none;">
<label for="jumpAfter">Aantal incrementele sleutels voor sprong:</label>
<input type="number" id="jumpAfter" value="1000" min="1"><br>
<label for="activeKeys">Aantal verwachte actieve sleutels binnen interval:</label>
<input type="number" id="activeKeys" value="1000" min="1"><br>
</div>

<button id="startBtn">Start zoeken</button>
<button id="stopBtn" disabled>Stop</button>

<div id="totaal">Totaal gescande adressen: 0</div>
<div id="errors">Aantal errors: 0</div>
<div id="progressAbs">Voortgang in keyspace: 0.000000000000000000000000000000 %</div>
<div id="progressRel">Voortgang in interval: 0.000000000000000000000000000000 %</div>

<div id="retryMsg"></div>
<div id="foundMsg"></div>

<table id="resultTable">
<thead>
<tr>
<th>#</th>
<th>Adres</th>
<th>WIF</th>
<th>Type</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
// ===== Helpers =====
function toHex(bytes){return Array.from(bytes).map(b=>b.toString(16).padStart(2,"0")).join("");}
function hexToBytes(hex){const out=new Uint8Array(hex.length/2);for(let i=0;i<out.length;i++) out[i]=parseInt(hex.substr(i*2,2),16);return out;}
function sha256Hex(hex){return CryptoJS.SHA256(CryptoJS.enc.Hex.parse(hex)).toString();}
function doubleSha256Hex(hex){return sha256Hex(sha256Hex(hex));}
function base58Encode(hex){
  const alphabet="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";
  const bytes=hexToBytes(hex);let zeros=0;
  while(zeros<bytes.length&&bytes[zeros]===0) zeros++;
  let num=BigInt("0x"+hex);let out="";
  while(num>0n){let r=num%58n;num/=58n;out=alphabet[Number(r)]+out;}
  return "1".repeat(zeros)+(out||"");
}

// ===== Keyspace =====
const ORDER_N = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141n;
const MAX_VALID_KEY = ORDER_N-1n;
const KEYSPACE_SIZE = MAX_VALID_KEY;

// ===== Random key in percentage-range =====
function genRandomKeyInRange(startPercent, endPercent) {
  const rangeStart = (KEYSPACE_SIZE * BigInt(Math.floor(startPercent * 1e6))) / 100000000n;
  const rangeEnd   = (KEYSPACE_SIZE * BigInt(Math.floor(endPercent * 1e6))) / 100000000n;
  const rangeSize = rangeEnd - rangeStart;
  let rand;
  do {
    const arr = new Uint8Array(32);
    crypto.getRandomValues(arr);
    rand = BigInt("0x"+Array.from(arr,b=>b.toString(16).padStart(2,"0")).join(""));
  } while(rand > MAX_VALID_KEY);
  return (rand % rangeSize) + rangeStart;
}

// ===== Variabelen =====
let counter=0, totaal=0, zoeken=false, MAX_VISIBLE=250;
let batchSize=2, batchRate=5;
let startPercent=10, endPercent=20, mode="random";
let stepSize=1, numSteps=1000000, currentKey=null;
let incrementCount=0, expectedStep=0n, jumpAfter=1000, activeKeys=1000;

// ===== Target adressen ====
const TARGET_ADDRESSES = new Set([
  "1FeexV6bAHb8ybZjqQMjJrcCrHGW9sb6uF",
  "1Ay8vMC7R1UbyCCZRVULMV7iQpHSAbguJP",
  "1LdRcdxfbSnmCYYNdeYpUnztiYzVfBEQeC",
  "1AC4fMwgY8j9onSbXEWeH6Zan8QGMSdmtA",
  "1LruNZjwamWJXThX2Y8C2d47QqhAkkc5os",
  "1Pzaqw98PeRfyHypfqyEgg5yycJRsENrE7",
  "1N7jWmv63mkMdsYzbNUVHbEYDQfcq1u8Yp",
  "15cHRgVrGKz7qp2JL2N5mkB2MCFGLcnHxv",
  "1PeizMg76Cf96nUQrYg8xuoZWLQozU5zGW",
  "1GR9qNz7zgtaW5HwwVpEJWMnGWhsbsieCG",
  "1CNtkWbb4grh8xtb8mhoZ6armNE9PHgzA8",
  "1F34duy2eeMz5mSrvFepVzy7Y1rBsnAyWC",
  "1DcoAJJmCexsYCF8h9qBzduNDo2cXAWXFe",
  "1Q8QR5k32hexiMQnRgkJ6fmmjn5fMWhdv9",
  "1Ki3WTEEqTLPNsN5cGTsMkL2sJ4m5mdCXT",
  "1DzsfLRDfbmQM99xm59au2SrTY3YmciBSB",
  "1GUfWdZQoo2pQ4BKHsiegxuZPnheY5ueTm",
  "12HnxiXEeKUVjQRbMVTytsGWnzHd5LdGCt",
  "17uULjz9moeLyjXHoKNwDRgKzf8ahY3Jia",
  "18qNs1yBGGKR8RyErnEF5kegbNUgPfixhS",
  "1DP3VYwN6ozHXDDaETbvNFLd86CAXfaewi",
  "1NhJGUJu8rrTwPS4vopsdTqqcK4nAwdLwJ",
  "1MewpRkpcbFdqamPPYc1bXa9AJ189Succy",
  "1MtUMTqtdrpT6Rar5fgWoyrzAevatssej5",
  "1H2MXWiSniAgg7ykdXEzPHL6oTH1ic4kP",
  "1DcT5Wij5tfb3oVViF8mA8p4WrG98ahZPT",
  "1CY7fykRLWXeSbKB885Kr4KjQxmDdvW923",
  "1P9fAFAsSLRmMu2P7wZ5CXDPRfLSWTy9N8",
  "1HLvaTs3zR3oev9ya7Pzp3GB9Gqfg6XYJT",
  "162bzZT2hJfv5Gm3ZmWfWfHJjCtMD6rHhw",
  "187zSqAYwMKJAxWdWQ4fmp5DyT6G2NPgD7",
  "1MwQyJLNerHPVMTQXKAbQrnwF9VortvuAf",
  "18zuLTKQnLjp987LdxuYvjekYnNAvXif2b",
  "198aMn6ZYAczwrE5NvNTUMyJ5qkfy4g3Hi",
  "15Z5YJaaNSxeynvr6uW6jQZLwq3n1Hu6RX",
  "14B4ceT9HWX1njZWB7an1zQAY9zXX352EQ",
  "19tiUa9nsPTgaqWNHaM9QyCfv4Wm9dVeYa",
  "1FZcb6BU1ZbHQJcby7vDF2Na1z9UmkGSSG",
  "1C1sUtw6fYa1Yr5wexrH2ayT1ZykD9Sobx",
  "143gLvWYUojXaWZRrxquRKpVNTkhmr415B",
  "13eEt6myAo1zAC7o7RK5sVxxCNCAgd6ApH",
  "1DzjE3ANaKLasY2n6e5ToJ4CQCXrvDvwsf",
  "1FJuzzQFVMbiMGw6JtcXefdD64amy7mSCF",
  "1PJiGp2yDLvUgqeBsuZVCBADArNsk6XEiw",
  "186XqVoL7TGxR3osoo4xn32wbYtb527raY",
  "1Ac2JdpQ5c9NeSajdGx6dofxeXkn4S35ft",
  "19dNe9Xg6JWvszgU3NuM6TNd2wHmANPbHB",
  "1pChUJ9WQhWtqyt5RtSnLarZYQztZsbzi",
  "1AYLzYN7SGu5FQLBTADBzqKm4b6Udt6Bw6",
  "1NpZcfBnaJeoRT9ZqwZVRMw3SRs546VsuE",
  "1LVYbnSX6f6vE2Zn4zs2oZ4eKyBgzkqaay",
  "147sPaNaqeyQp8GS2oAUajhb9d4PZ9xAv9",
  "1PjPfocmxS262puhYqUwaagE9zBJTZHGwK",
  "1NSbFq6rCeSC1p2EBrov5R1uUTFRBu8tcs",
  "1NFPNeet3ygvVZtDbxYeLECfs7g7vH8PSV",
  "1HmiKJMQH4569UMpeGX2QStUfpjx7pBKhW",
  "16b8LpbDa38xrAQHVVDrC3xyztPdRaX5a2",
  "14Ngt4akcnVgaoAMxoMqz9rPcP3bYsGbbM",
  "1MJZLeLbsoSf2kuDr5gAX3QE93BvhvqkCC",
  "1JCozFUFS5TBAAbnrr9jRWDVQURo2kGeRq",
  "1DFv3qVAbravZBZqHmoEphMDtTs2zXPYXk",
  "19CkUw43czT8yQctnHXNiB5ivNtibWbzqS",
  "1JxmKkNK1b3p7r8DDPtnNmGeLZDcgPadJb",
  "1Cr7EjvS8C7gfarREHCvFhd9gT3r46pfLb",
  "18SN8PV997oDGtYmTPPD55GDaPtNNEGWeu",
  "1LBBmkr9muf7RjjBbzQQvzNQpRRaVEnavs",
  "16rF2zwSJ9goQ9fZfYoti5LsUqqegb5RnA",
  "1AkJq3KKGpKQDVRzVYR6SxdzToM47nopdV",
  "1MbNM3jwxMjRzeA9xyHbMyePN68MY4Jxb",
  "1FY6RL8Ju9b6CGsHTK68yYEcnzUasufyCe",
  "1BsdDaJtgFZrLfzEXvh6cD4VhtHHSHhMea",
  "1Lj2mCPJYbbC2X6oYwV6sXnE8CZ4heK5UD",
  "1JtAupan5MSPXxSsWFiwA79bY9LD2Ga1je",
  "1HvZQX9XkFFaNa8d5VpwMcYkyebyp6cCXM",
  "12VuUfQHTGqWDvBzm8TBad1mZBm4hjGEzN",
  "1FvkWMMH9MDMACHqynrerzduaQ5AjjZKDA",
  "138EMxwMtKuvCEUtm4qUfT2x344TSReyiT",
  "1D3mERfHYY2e96HKUZUsXX7HqHkqUFEadv",
  "14UeyAD9rQCSJgdJzuzFgShq84gW62Bsat",
  "1DDWbJhKqfidczaHF1ugGP2KzPgcaU3tGD",
  "13n67sFKgqLDKp8gx8Xvm6scdfY4ZeaU8p",
  "1EF3T11bL7yua2yJo4waaQ3RgewNwRnKMw",
  "19oLGXykNUBj8f7w1tT9emuaEbaSFj1p27",
  "15SGg7PpcJ7bMhENw4gc3Qp4LT6c5uLGza",
  "1Cw9Kyr8hKsucXTtcwuGVqeBHDrnRtXC8D",
  "1DR93bfKVCUJkDvPuxbUAEtzYRaJEnwjNt",
  "1AwimXdGoX8nR9dMagCDMGJQB62GNHgrqM",
  "1FUpBduq45UfULPACj1Phw9hRvwroJqYUX",
  "1GuLYGgr9FZwCBBQfDmMiJfTF4cvyrJSeu",
  "152BK6BQa672Dy8PHf4JQtS27pBRBiYy6e",
  "1Ly9nQEyaRQoRPSAE4dABrpav2SaAR383W",
  "154sxXJekWHQ5nPxkkaWnMghy4o9qWaNdU",
  "1Gc6ggvqHRRwyyx6rrW9Wn17bqzV7voWvD",
  "1CCqLR8YrUMPFgYZWwLW8FkezbFjfeXD8n",
  "1D387jd5ZuvudpUQrSv8vK5b2M1SBnvdY8"
]);

// ===== Progress =====
function getProgressAbsolute(currentKey){ return (Number(currentKey)/Number(KEYSPACE_SIZE)*100).toFixed(30)+" %"; }
function getProgressRelative(currentKey){ return (((Number(currentKey)/Number(KEYSPACE_SIZE)*100)-startPercent)/(endPercent-startPercent)*100).toFixed(30)+" %"; }

// ===== Start / Stop =====
async function starten(){
  if(zoeken) return;

  startPercent = parseFloat(document.getElementById("startPercent").value);
  endPercent   = parseFloat(document.getElementById("endPercent").value);
  mode         = document.getElementById("mode").value;
  numSteps     = parseInt(document.getElementById("numSteps").value);

  if(mode==="incremental" || mode==="hybrid"){
    const rangeStart = (KEYSPACE_SIZE * BigInt(Math.floor(startPercent * 1e6))) / 100000000n;
    const rangeEnd   = (KEYSPACE_SIZE * BigInt(Math.floor(endPercent * 1e6))) / 100000000n;
    const rangeSize  = rangeEnd - rangeStart;
    stepSize         = rangeSize / BigInt(numSteps);
    currentKey       = rangeStart;
  }

  if(mode==="hybrid"){
    jumpAfter = parseInt(document.getElementById("jumpAfter").value);
    activeKeys = parseInt(document.getElementById("activeKeys").value);
    incrementCount = 0;
    const stepPerActive = (KEYSPACE_SIZE * BigInt(Math.floor((endPercent-startPercent)*1e6))/100000000n)/BigInt(activeKeys);
    const startRandomOffset = BigInt(Math.floor(Math.random()*Number(stepPerActive)));
    currentKey = ((KEYSPACE_SIZE * BigInt(Math.floor(startPercent*1e6)))/100000000n) + startRandomOffset;
    expectedStep = stepPerActive;
  }

  zoeken=true;
  document.getElementById("startBtn").disabled=true;
  document.getElementById("stopBtn").disabled=false;
  document.getElementById("foundMsg").textContent="";
  if(mode==="hybrid") genereerHybrid();
  else genereerBatch();
}

function stoppen(){zoeken=false; document.getElementById("startBtn").disabled=false; document.getElementById("stopBtn").disabled=true; }

// ===== Batch generator =====
async function genereerBatch(){
  if(!zoeken) return;
  const privKeys=[];
  for(let i=0;i<batchSize;i++){ 
    if (mode==="random") privKeys.push(genRandomKeyInRange(startPercent,endPercent));
    else { privKeys.push(currentKey); currentKey+=BigInt(stepSize); }
  }

  const addresses=[];
  for(const k of privKeys){
    const privHex=k.toString(16).padStart(64,'0');
    const ec=new elliptic.ec("secp256k1"); 
    const kp=ec.keyFromPrivate(privHex,"hex");
    const pubU=toHex(kp.getPublic(false,'array'));
    const ripemdU=CryptoJS.RIPEMD160(CryptoJS.enc.Hex.parse(sha256Hex(pubU))).toString();
    const payloadU='00'+ripemdU;
    const checksumU=doubleSha256Hex(payloadU).slice(0,8);
    const addressU=base58Encode(payloadU+checksumU);
    const wifU=base58Encode('80'+privHex+doubleSha256Hex('80'+privHex).slice(0,8));
    addresses.push({address:addressU,wif:wifU,type:'Uncompressed',priv:k});
  }

  for(const a of addresses){
    counter++; totaal++;
    const row=document.createElement('tr');
    row.innerHTML=`<td>${counter}</td><td>${a.address}</td><td>${a.wif}</td><td>${a.type}</td>`;
    document.querySelector("#resultTable tbody").appendChild(row);

    // Stop bij target adres
    if(TARGET_ADDRESSES.has(a.address)){
      row.style.backgroundColor="#c8f7c5";
      document.getElementById("foundMsg").textContent=`🎉 Target adres gevonden!\nAdres: ${a.address}\nWIF: ${a.wif}`;
      zoeken=false; 
      document.getElementById("startBtn").disabled=true;
      document.getElementById("stopBtn").disabled=true;
      return;
    }

    document.getElementById("progressAbs").textContent="Voortgang in keyspace: "+getProgressAbsolute(a.priv);
    document.getElementById("progressRel").textContent="Voortgang in interval: "+getProgressRelative(a.priv);
  }

  const tbody=document.querySelector("#resultTable tbody");
  while(tbody.rows.length>MAX_VISIBLE) tbody.deleteRow(0);
  document.getElementById("totaal").textContent="Totaal gescande adressen: "+totaal;

  if(zoeken) setTimeout(genereerBatch,1000/batchRate);
}

// ===== Hybrid generator =====
async function genereerHybrid(){
  if(!zoeken) return;

  const privHex=currentKey.toString(16).padStart(64,'0');
  const ec=new elliptic.ec("secp256k1"); 
  const kp=ec.keyFromPrivate(privHex,"hex");
  const pubU=toHex(kp.getPublic(false,'array'));
  const ripemdU=CryptoJS.RIPEMD160(CryptoJS.enc.Hex.parse(sha256Hex(pubU))).toString();
  const payloadU='00'+ripemdU;
  const checksumU=doubleSha256Hex(payloadU).slice(0,8);
  const addressU=base58Encode(payloadU+checksumU);
  const wifU=base58Encode('80'+privHex+doubleSha256Hex('80'+privHex).slice(0,8));

  counter++; totaal++;
    const row=document.createElement('tr');
  row.innerHTML=`<td>${counter}</td><td>${addressU}</td><td>${wifU}</td><td>Uncompressed</td>`;
  document.querySelector("#resultTable tbody").appendChild(row);

  // Stop bij target adres
  if(TARGET_ADDRESSES.has(addressU)){
    row.style.backgroundColor="#c8f7c5";
    document.getElementById("foundMsg").textContent=`🎉 Target adres gevonden!\nAdres: ${addressU}\nWIF: ${wifU}`;
    zoeken=false; 
    document.getElementById("startBtn").disabled=true;
    document.getElementById("stopBtn").disabled=true;
    return;
  }

  // Incrementale logica binnen hybride
  currentKey += 1n;
  incrementCount++;

  if(incrementCount >= jumpAfter){
    const halfStep = expectedStep / 2n;
    const randOffset = BigInt(Math.floor(Math.random()*Number(expectedStep))) - halfStep;
    currentKey = currentKey + expectedStep + randOffset;

    // Zorg dat we binnen het interval blijven
    const rangeStart = (KEYSPACE_SIZE * BigInt(Math.floor(startPercent * 1e6))) / 100000000n;
    const rangeEnd   = (KEYSPACE_SIZE * BigInt(Math.floor(endPercent * 1e6))) / 100000000n;
    if(currentKey > rangeEnd) currentKey = rangeStart + (currentKey - rangeEnd);
    incrementCount = 0;
  }

  document.getElementById("progressAbs").textContent="Voortgang in keyspace: "+getProgressAbsolute(currentKey);
  document.getElementById("progressRel").textContent="Voortgang in interval: "+getProgressRelative(currentKey);

  const tbody=document.querySelector("#resultTable tbody");
  while(tbody.rows.length>MAX_VISIBLE) tbody.deleteRow(0);
  document.getElementById("totaal").textContent="Totaal gescande adressen: "+totaal;

  if(zoeken) setTimeout(genereerHybrid,1);
}

// ===== Event listeners =====
document.getElementById("startBtn").addEventListener("click",starten);
document.getElementById("stopBtn").addEventListener("click",stoppen);
document.getElementById("mode").addEventListener("change",()=>{
  document.getElementById("hybridSettings").style.display = document.getElementById("mode").value==="hybrid" ? "block" : "none";
});
</script>
</body>
</html>
